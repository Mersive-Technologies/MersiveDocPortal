<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>[%=Heading.Level1%]</title>
    </head>
    <body>
        <h1>Default USB Audio Device Prioritization and Override</h1>
        <p>Solstice Pods attempt to provide consistent behavior related to audio when USB devices are plugged in and removed. When USB audio devices are plugged into a Pod, the Pod considers the following properties (from high to low priority) to decide which device will be used for audio capture and playback:</p>
        <h4>Prioritization by Device Type</h4>
        <ul>
            <li>Speakerphones are the highest priority device type due to their echo-cancelling abilities. A speakerphone will take precedence over standalone speakers and standalone microphones.</li>
            <li>Standalone speakers and standalone microphones are of equal priority. If a standalone speaker and a standalone microphone are plugged in at the same time it is assumed that they might be used together and both will be available.</li>
            <li>If there is a tie – for example between two speakerphones, standalone speakers, or standalone microphones – the next prioritization property will be assessed to break the tie.</li>
        </ul>
        <h4>Prioritization by USB Port Address</h4>
        <ul>
            <li>Lower USB port addresses take precedence over higher USB port addresses. On a Gen3 Solstice Pod, there are two USB-A ports on the back which may be used. The USB port next to the 3.5mm stereo out jack has a lower port address (USB Port 1) and thus will be prioritized over the USB port next to the HDMI out ports (USB Port 2). <p>For example, if there are two USB speakerphones plugged in, the one closer to the 3.5mm stereo out jack (USB Port 1) will be selected over the one next to the HDMI out ports (USB Port 2).</p></li>
            <li>If a USB hub is plugged into one of the Pod's USB ports, the same port address logic applies. You may need to play around with the hub to find which port has the lowest address. Keep in mind that this information is only used for breaking ties between devices of equal priority.</li>
        </ul>
        <p>&#160;</p>
        <h2>Overriding Default USB Audio Device Prioritization</h2>
        <p>If the default USB audio device prioritization logic does not satisfy the needs of a particular installation, an integrator can override it using the Solstice Open Control API v2.
</p>
        <p>One example of this might be high-end room microphones coupled with a conference device that has a camera and speakerphone. In this case, the room-integrated microphones are preferred over the conference device's microphone, and the default prioritization logic can be overridden as follows:</p>
        <ul>
            <li>Send an HTTP request to the Pod to query the available USB audio devices. Take note of the complete name corresponding to the room-integrated microphones. (See <code>usb_audio_devices</code> in <a href="https://documentation.mersive.com/content/topics/opencontrolapi_2_0.html#solstice-open-control-api-info" target="_blank">Open Control API v2 &gt; Info</a> for more information.)<p>The command:</p><p class="codeblock">curl -s -k -H "Authorization: Bearer $token" https://$POD_IP:5443/v2/info -X GET | jq -r '.usb_audio_devices'</p><p class="note" style="margin-left:5%">Note that the binary <code>jq</code> needs to be installed and in the current <code>PATH</code> environment variable.</p><p>Might return something like:</p><p class="codeblock"> [<br />&#160;&#160;"USB-Audio - My Awesome Microphone"<br />]</p></li>
            <li>A second HTTP request may then be sent to the Pod telling it to always prefer <code>My Awesome Microphone</code>, if it is available. If the device is not available, normal prioritization logic will be used.<p class="codeblock">curl -ki -H "Authorization: Bearer $token" https://$POD_IP:5443/v2/config -X PATCH -d ‘{“audio”: { “usb”: { “microphone”: { “override”: "USB-Audio - My Awesome Microphone" }}}}’</p><p class="warning" style="margin-left:5%">Copying and pasting into some terminals may substitute the wrong quotation mark characters. Writing out the JSON (rather than copying and pasting) is recommended. You can also write the JSON into a file and tell curl to upload it with: <code>-d @audio_override.json</code></p><p class="note" style="margin-left:5%">Sending the second HTTP request does not automatically change the USB audio selection over to the preferred device. Either restart the Solstice Pod or manually unplug and plug back in the preferred device. <br />In the above example, rebooting the Pod or unplugging/replugging the room-integrated microphone will enact the override.</p><p class="tip" style="margin-left:5%">To remove an override, use an empty string in your HTTP request, rather than the name of a device. Factory resets will also clear the overrides.</p></li>
            <li>The override can be verified with:<p class="codeblock">curl -k -H "Authorization: Bearer $token" https://$POD_IP:5443/v2/config | jq -r .audio</p><p>The above should return:</p><p class="codeblock">{
				<br />&#160;&#160;"usb": {<br />&#160;&#160;&#160;&#160;"microphone": {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;"override": "USB-AUDIO - My Awesome Microphone"<br />&#160;&#160;&#160;&#160;},<br />&#160;&#160;&#160;&#160;"speaker": {<br />&#160;&#160;&#160;&#160;&#160;&#160;"override": ""<br />&#160;&#160;&#160;&#160;}<br />&#160;&#160;}<br />}</p></li>
        </ul>
        <p>&#160;</p>
        <h3 MadCap:conditions="Default.ScreenOnly">Related Topics</h3>
        <p MadCap:conditions="Default.ScreenOnly"><a href="Solstice-Conference-Supported-Peripherals.htm">Solstice Conference Supported Peripherals</a>
        </p>
        <p MadCap:conditions="Default.ScreenOnly"><a href="API-OpenControl-Overview.htm">Open Control API Overview</a>
        </p>
        <p>&#160;</p>
    </body>
</html>
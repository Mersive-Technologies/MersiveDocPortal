<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="mc-master-page: url('..\Resources\MasterPages\OtherTopics.flmsp');">
    <head><title>[%=Heading.Level1%]</title>
    </head>
    <body>
        <h1>Deploy Mersive Solstice Apps with MSI</h1>
        <p>MSI installers  for the Mersive Solstice app and Solstice Conference drivers allow for a GUI-based installation on a local machine or GPO deployment in Active Directory. This allows IT administrators to centrally deploy the Mersive Solstice app and Solstice Conference for Windows users.</p>
        <p>Starting in Solstice 5.5, there are separate MSI&#160;installers for the Mersive Solstice app (SolsticeClient-5.5.msi) and the Mersive Solstice Conference drivers (SolsticeConferenceDrivers-1.3.msi). First run the Mersive Solstice app  installer, then install the Mersive Solstice Conference drivers. Note that  these installers must be run with administrator privileges. Mersive recommends using MSI installers in a remote deployment using either an administrator or the SYSTEM account to install them properly. Because of this, admin-installed versions of the Mersive Solstice app and Mersive Solstice Conference drivers cannot be auto-updated by users upon connecting to a Pod running a newer version of Solstice.</p>
        <p class="note"> In Solstice 5.4 and earlier, the Mersive Solstice app installer (e.g., SolsticeClient-5.4.msi) will also install the Mersive Solstice Conference drivers.</p>
        <p>The MSI installers can be run either interactively, specifying options through the GUI, or silently, specifying installation parameters directly on the command line to make automated deployment easier. </p>
        <p class="table-text">&#160;</p>
        <p class="warning"><b>Important Note:</b> If Solstice Conference capabilities are currently installed from a 5.3 or 5.3.1 version of the Mersive Solstice app, admins centrally upgrading the app via MSI <b style="text-decoration: underline;">will first need to remotely reboot the user machine</b> and then uninstall the previous version of the app via MSI before upgrading. Admins can use the following command lines for uninstalling the 5.3 or 5.3.1 versions of the app: <br /><br /><b>5.3:</b><br />msiexec /x “{8cca01d5-9b6f-4474-9409-d5a586c3c2e7}” AFTERBOOT=1 /quiet<br /><br /><b>5.3.1:</b><br />msiexec /x “{b4efba4f-8b7f-42e4-a991-c779da1bff58}” AFTERBOOT=1 /quiet<br /><br />After running the uninstall command, admins can then install the newer version of the app via MSI as normal. If Solstice Conference capabilities are not currently installed, admins can upgrade or uninstall as normal. </p>
        <p class="table-text">&#160;</p>
        <h2>Mersive Solstice App  Installer Values</h2>
        <p>The current values that can be set during installation of version 5.5 of the Mersive Solstice app (SolsticeClient-5.5.msi) are as follows:</p>
        <p class="note">Mersive MSI&#160;installers are case sensitive. Installation options must be specified in capital letters. </p>
        <p><b>INSTALLDIR=path</b> controls where the Mersive Solstice app will be installed.  The default is: C:\Program Files\Mersive Technologies, Inc\Solstice\Client </p>
        <p><b>STARTONLOGIN={0|1}</b>  controls whether the app will auto launch when a user logs in.  A value of 1 means the app will start automatically; 0 means it will not.  </p>
        <p><b>STARTDOCKED={0|1}</b>  determines whether or not the app starts in docked mode. A value of 1 sets the app to start in docked mode; 0 opens the app's UI window on start.</p>
        <p><b>ADDSHORTCUT={0|1}</b> determines whether an icon for the Mersive Solstice app is added to the user's desktop. A value of 1 adds the icon to the desktop.</p>
        <p><b>SDSADDRESS=address</b> where 'address' can be a domain name (e.g., sdshost.yourcompany.com) or an IP address (e.g., 123.4.5.67).  This sets the initial value of the Solstice Discovery Service Address in the app (Settings &gt; General).  If this parameter is not given, the app’s SDS Address will not be modified. </p>
        <p><b>NAME=”user name with spaces”</b> sets a user's Display Name value in the app (Settings &gt; General). If this value is not set, the user will be asked to enter a name when they first run the app.  If a name value contains spaces, it needs to be surrounded by quotes.</p>
        <p><b>DEFAULTNAME={0|1}</b> controls whether to set the user's Display Name in the app (Settings &gt; General) to be the name of the computer the app is being installed on. A value of 1 set the user's name to the computer name. If both DEFAULTNAME=1 and a NAME&#160;value are specified, the Display Name will be set to the machine name (DEFAULTNAME setting takes precedence).</p>
        <p><b>NOTIFICATIONLEVEL={0-2}</b>    sets how many Notifications (Settings &gt; General) the user will see. A value of 0 disables all notifications; 1 displays only critical notifications; 2 results in the user seeing all notifications.</p>
        <MadCap:snippetBlock src="../Resources/Snippets/info_UserAppNotificationsOffConfWarning.flsnp" />
        <p><b>AUTOSHAREDESKTOP={0|1}</b>    sets whether Solstice automatically shares the user's desktop as soon as they connect to a Solstice display. A value of 1 sets Quick Share Desktop (Settings &gt; Control) to on; 0 disables it.</p>
        <p><b>AUTOSHAREAUDIO={0|1}</b>    sets whether audio is automatically shared  when the user shares their desktop or an application window. A value of 1 sets Auto Share Audio (Settings &gt; Control) to on; 0 disables it.</p>
        <p><b>HIDEUIWHENSHARING={0|1}</b>  controls whether the app's User Interface (UI) is hidden when the desktop is being shared.  This is a convenient shortcut so it doesn’t get in the way of content being shared.  A value of 1 sets Hide on Desktop Share (Settings &gt;&#160;Control) to on; 0 disables automatic desktop sharing.</p>
        <p><b>SLSDISCONNECTSENSITIVITY=[0-5]</b> affects how the Solstice Location Service&#160;applies auto-disconnect logic to a user's Pod connection. Choose an auto-disconnect sensitivity between 1 (very low) and 5 (very high). A value of 0 disables auto-disconnect.</p>
        <p><b>POWERPOINTEXTENDDISPLAY={0|1}</b> controls the Extended Presentation Mode setting (Settings &gt; Control) upon install. A value of 1 turns on Extended Presentation Mode; 0 turns it off. If no value is specified, defaults to 1.</p>
        <p><b>SHAREPODDISPLAY={0|1}</b> determines whether the Share Pod Display setting for Solstice Conference (Settings &gt; Conference) is enabled or disabled. A value of 1 turns on the Share Pod Display toggle; 0 turns it off for better performance on some devices. If this parameter is not given, the Share Pod Display setting will be set to on.</p>
        <p><b>HIDECONFERENCE={0|1}</b> hides the Solstice Conference functionality in the Mersive Solstice app from end-users. A value of 1 hides Solstice Conference–specific functions.</p>
        <p><b>HIDESETTINGS={0|1}</b> hides the settings options and configurations from end-users. A value of 1 hides the settings; 0 allows users to view and configure settings.</p>
        <MadCap:snippetBlock src="../Resources/Snippets/info_MSI-SCCMInstallerSettingsPath.flsnp" />
        <h2>Examples</h2>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Install the Mersive Solstice App with 'msiexec' from the Command Line</MadCap:dropDownHotspot>
                <br />
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p class="note">Mersive recommends uninstalling any 32-bit versions of the Mersive Solstice app and Solstice Conference drivers for Windows before installing a 64-bit version. The 64-bit installer will remove any previously installed version of the 64-bit app, but it will not remove a previously installed 32-bit version. The Mersive Solstice app for Windows versions 5.3 and newer were released only in 64-bit. Learn more about <a href="#uninstall">uninstalling Mersive Solstice apps from the command line</a>.</p>
                <p>Here is an example of how to use <code>msiexec</code> to install the Mersive Solstice app with the following options:</p>
                <ul>
                    <li>Set the SDS address to <code>sdshost.yourcompany.com</code></li>
                    <li>Install the app in the directory <code>C:\Program Files\Mersive\SolsticeClient</code></li>
                    <li>Not start the app on login</li>
                    <li>Hide the user interface when sharing the desktop</li>
                    <li>Install the app silently</li>
                    <li>Write an installation log file named <code>C:\SolsticeClient.log</code></li>
                </ul>
                <p class="codeblock">msiexec /i SolsticeClient-5.5.msi SDSADDRESS=sdshost.yourcompany.com  INSTALLDIR="C:\Program Files\Mersive\SolsticeClient" STARTONLOGIN=0 HIDEUIWHENSHARING=1 /quiet /log c:\SolsticeClient.log</p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Install Mersive Solstice Conference with 'msiexec' from the Command Line</MadCap:dropDownHotspot>
                <br />
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>In some circumstances the Mersive Solstice Conference driver installer does not finish successfully because a previous version of the drivers cannot be fully uninstalled. In this case, the installer should be run again after Windows has been restarted. Use the <code>/norestart</code> option with <code>msiexec</code>, as shown in the example below, to keep Windows from restarting automatically during a silent install.</p>
                <p class="note">Note that the Mersive Solstice app–only installer in version 5.5 and higher (e.g., SolsticeClient-5.5.msi) will not uninstall previous versions of the Solstice Conference drivers. Mersive Solstice Conference may be uninstalled from the Windows add/remove programs list, or with the <code>msiexec</code> commands shown in <a href="#uninstall">Uninstalling with 'msiexec'</a> below.</p>
                <MadCap:snippetBlock src="../Resources/Snippets/info_Conf1-0-7CompatibilityWith5-5Tip.flsnp" />
                <p>Here is an example of how to use <code>msiexec</code> to install the Mersive Solstice Conference drivers with Mersive Solstice 5.5 and higher with the following command line options:</p>
                <ul>
                    <li>Wait until the installation has finished to return an error code (3010 = install succeeded but needs a reboot to complete, 1603 = reboot and retry install)</li>
                    <li>Suppress a Windows restart if one is required to finish the installation</li>
                    <li>Install the Mersive Solstice Conference drivers silently</li>
                    <li>Write an installation log file named <code>C:\SolsticeConference.log</code></li>
                </ul>
                <p class="codeblock">start /wait msiexec /i SolsticeConferenceDrivers-1.3.msi /norestart /quiet /log c:\SolsticeConference.log</p>
                <p>There are currently no configuration values to be set during the Mersive Solstice Conference drivers installation.</p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Uninstall Mersive Solstice and Solstice Conference Drivers with 'msiexec'</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p><a name="uninstall"></a>The command below shows an example of how to use <code>msiexec</code> to uninstall the Mersive Solstice app:</p>
                <p class="codeblock">msiexec /x SolsticeClient-5.5.msi /quiet /log c:\SolsticeClient.log</p>
                <p>This command shows an example of how to use <code>msiexec</code> to uninstall the Mersive Solstice Conference drivers separately from versions 5.5 and higher of the Mersive Solstice app:</p>
                <p class="codeblock">msiexec /x SolsticeConferenceDrivers-1.3.msi /norestart /quiet /log c:\SolsticeConference.log</p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Pre-Install Mersive Trust Certificate for Mersive Solstice App Versions 5.4 and Earlier</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>When installing the Solstice Conference drivers in the combined installer with versions 5.4 and earlier of the Mersive Solstice app, a confirmation screen appears that requires the user to explicitly trust software from Mersive. To eliminate this confirmation step in silent installs, pre-install the Mersive trust certificate on computers on which the app is to be installed. Below are steps to accomplish this locally on a single machine. </p>
                <p>This confirmation is no longer required to install Solstice Conference drivers version 1.3 (compatible with version 5.5 of the Mersive Solstice app) and higher.</p>
                <p class="note">If you are deploying centrally to multiple Windows computers, you can use Microsoft’s Group Policy or another third-party tool to add the Mersive publisher certificate to the Trusted Publishers certificate store.</p>
                <ol>
                    <li>From a computer that does not have Solstice Conference installed with the Mersive Solstice app, run the version 5.4 or earlier MSI&#160;installation file (e.g., SolsticeClient-5.4.msi). <ol style="list-style-type: lower-alpha;"><li>If you are working with a computer that already has Solstice Conference installed, skip to step 5.</li></ol></li>
                    <li>Work through the installation wizard, and select the <b>Install Solstice Conference</b> option. <p><img src="../Resources/Images/ex_UserAppMSIInstallerInstlConf.png" style="width: 550px;" /></p></li>
                    <li>Continue the installation wizard.<p>When the installation starts, you will be prompted to trust Mersive software.</p><p><img src="../Resources/Images/ex_UserAppMSIInstallerTrust.png" /></p></li>
                    <li>Check <b>Always trust software from "Mersive Technologies, Inc.</b> and click <b>Install</b>. The Mersive trust certificate will be installed on the computer.</li>
                    <li>On the Windows start menu, enter <b>certmgr.msc</b></li>
                    <li>From the <code>certmgr</code> dialog, navigate to <b>Trusted Publishers &gt; Certificates</b>.</li>
                    <li>Right click the Mersive certificate and select <b>All Tasks &gt; Export</b>.</li>
                    <li>Click <b>Next</b>, and then click <b>Next</b> again.</li>
                    <li>Enter the file name for the Mersive certificate (e.g., <code>mersive_cert.cer</code>). You can also use the Browse dialog to specify both the name and the location of the file.</li>
                    <li>Click <b>Next</b>, and then click <b>Finish</b>.</li>
                    <li>Place the SolsticeClient-5.4.msi file and the trust certificate you just exported, into the same folder or on the same share where they can used for installation.</li>
                    <li>On the Windows computer where you want to perform the silent install, open a command prompt with Administrator permissions.</li>
                    <li>Install the certificate by entering <code style="font-weight: normal;">certutil -addstore "TrustedPublisher" &lt;certificate name&gt;</code>.</li>
                    <li>Using <code>msiexec</code> run SolsticeClient-5.4.msi with the <code>quiet</code> (silent) option.</li>
                </ol>
                <p>For example, to run both <code>certutil</code> and <code>msiexec</code> from the same command, you could enter:</p>
                <p class="codeblock">certutil -addstore "TrustedPublisher" mersive_cert.cer &amp;&amp; msiexec /i SolsticeClient-5.4.msi SDSADDRESS=192.168.2.129  INSTALLDIR="C:\Program Files\Mersive\SolsticeClient" STARTONLOGIN=0 HIDEUIWHENSHARING=1 ADDCONFERENCE=1 /quiet /log c:\SolsticeClient.log</p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <h3>Related Topics</h3>
        <p><a href="Admin-SCCM-Instuctions.htm">Deploy Mersive Solstice App on Windows with SCCM</a>
        </p>
        <p><a href="Info-MacOS-CFPreferences.htm">Configure Mersive Solstice App Defaults on macOS</a>
        </p>
        <p>&#160;</p>
    </body>
</html>